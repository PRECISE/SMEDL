object frontend


state
float fts = 0;// timestamp of the first heartbeat event
int flag = 0;//ignore all track events until flag is 1
int size = 8;//subwindow num + pro buffer num
int hb_num = 0;//number of received newDetection events
int lastTime = 0;
int sub_size = 5000;
int delay = 1000;

events
imported newDetection(float, float, float, float, float);
imported track(float, string, int, float, float, float, float, float, float);
internal raiseHb();
exported hb_out();
exported track_out(float, string, int, float, float, float, float, float, float, float, int);//last two attributes: fts and number of sub intervals

scenarios

sce1:

init -> newDetection(ts, lat, lon, alt, snr) {lastTime = ts; fts = ts; flag = 1; hb_num = hb_num +1 ;raise raiseHb();} -> start

start -> newDetection(ts, lat, lon, alt, snr) when (ts > lastTime + sub_size + delay) { lastTime = lastTime + sub_size; hb_num = hb_num + 1; raise raiseHb();} -> start


//when receiving the 9th newDetection event, output result
sce2:
start -> raiseHb() when (hb_num > size) {raise hb_out();} -> start


sce3:

start -> track(ts, reportType, trackid, lat, lon, alt, vlat, vlon, valt) when (flag == 1) {raise track_out(ts, reportType, trackid, lat, lon, alt, vlat, vlon, valt, fts, hb_num);} -> start








